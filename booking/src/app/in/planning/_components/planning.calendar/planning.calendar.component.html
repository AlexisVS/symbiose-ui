<div>
    <planning-calendar-navbar [consumption]="hovered_consumption" [rental_unit]="hovered_rental_unit" [holidays]="hovered_holidays"></planning-calendar-navbar>
</div>

<div class="container">
    <mat-progress-bar [class.hidden]="!loading" mode="indeterminate"></mat-progress-bar>
    <table #calTable class="cal-table">
        <!-- header -->
        <thead>
            <tr class="head" >
                <td #calTableRefColumn class="ref-column cell-room" rowspan="2">ref.</td>
                <td class="stat-column cell-room" rowspan="2">stat.</td>
                <th class="head-months" *ngFor="let month of headers.months" [attr.colspan]="month.days.length" >
                    {{ month.date | date : 'MMMM y' }}
                </th>
            </tr>
            <tr class="head">
                <th #calTableHeadCells class="head-days" *ngFor="let day of headers.days" [class.small]="cells_width <= 26" [class.hidden]="cells_width < 10" [ngClass]="getHolidayClasses(day)">
                    <div *ngIf="cells_width > 26" class="week-day">{{ day | date: 'EEE'}}</div>
                    <div *ngIf="cells_width <= 26" class="week-day">{{ day | date: 'EEEEE'}}</div>
                    <div class="month-day">{{ day | date: 'd'}}</div>
                </th>
            </tr>
        </thead>
        <tbody>
            <!-- body -->
            <tr class="rows" *ngFor="let rental_unit of rental_units; let index = index;">
                <td class="cell-room">{{ rental_unit.name }}<span class="cell-hint">{{ rental_unit.name }}</span></td>
                <td class="cell-room" ><!--status--></td>

                <td *ngFor="let day of headers.days" class="cell-days" [class.is-weekend]="isWeekEnd(day)">

                    <div *ngIf="isToday(day)" class="is-today"></div>

                    <planning-calendar-booking
                        *ngIf="hasConsumption(rental_unit, day)"
                        [width]="cells_width"
                        [color]="colors[index % colors.length]"
                        [day]="day"
                        [consumption]="getConsumption(rental_unit, day)"
                        (hover)="onhoverBooking($event)"
                        (selected)="onSelectedBooking($event)">
                    </planning-calendar-booking>
                </td>
            </tr>
        </tbody>
    </table>
</div>